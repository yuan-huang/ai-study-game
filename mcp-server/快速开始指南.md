# ğŸ® æ¸¸æˆMCPæœåŠ¡å™¨ v2.0 - å¿«é€Ÿå¼€å§‹æŒ‡å—

## ğŸŒŸ æ–°ç‰ˆæœ¬äº®ç‚¹

### âœ¨ v2.0 é‡å¤§æ›´æ–°
- **ğŸ­ Gemini TTSé›†æˆ**: ä½¿ç”¨Gemini 2.5 Flash Preview TTSè¿›è¡Œå¯¹è¯éŸ³æ•ˆ
- **ğŸ”§ ç®€åŒ–é…ç½®**: ç»Ÿä¸€ä½¿ç”¨GEMINI_API_KEYï¼Œæ— éœ€é…ç½®Google Cloud
- **ğŸ¯ è§’è‰²åŒ–è¯­éŸ³**: 9ç§é¢„è®¾æ¸¸æˆè§’è‰²ï¼Œæ™ºèƒ½è¯­éŸ³é…ç½®
- **ğŸŒ å¤šè¯­è¨€æ”¯æŒ**: ä¸­æ–‡ã€è‹±æ–‡ã€æ—¥æ–‡ã€éŸ©æ–‡
- **âš¡ å³æ’å³ç”¨**: è®¾ç½®APIå¯†é’¥åç«‹å³å¯ç”¨

## ğŸš€ 30ç§’å¿«é€Ÿå¯åŠ¨

### 1. è¿è¡Œè‡ªåŠ¨å®‰è£… (æ¨è)
```bash
# åŒå‡»è¿è¡Œ
install.bat

# æˆ–å‘½ä»¤è¡Œè¿è¡Œ
.\install.bat
```

å®‰è£…è„šæœ¬ä¼šè‡ªåŠ¨ï¼š
- âœ… æ£€æŸ¥Node.jsç¯å¢ƒ
- âœ… å®‰è£…æ‰€æœ‰ä¾èµ–åŒ…
- âœ… é…ç½®Gemini APIå¯†é’¥
- âœ… ç¼–è¯‘TypeScripté¡¹ç›®
- âœ… åˆ›å»ºå¿…è¦ç›®å½•
- âœ… æµ‹è¯•APIè¿æ¥

### 2. å¯åŠ¨æœåŠ¡å™¨
```bash
npm start
```

## ğŸ¯ æ ¸å¿ƒåŠŸèƒ½æ¦‚è§ˆ

### ğŸ–¼ï¸ å›¾ç‰‡ç”Ÿæˆ
```javascript
// ç”Ÿæˆæ¸¸æˆè§’è‰²
{
  "tool": "generate_game_image",
  "arguments": {
    "prompt": "ä¸€ä¸ªå‹‡æ•¢çš„æˆ˜å£«ç«™åœ¨åŸå ¡å‰",
    "style": "pixel_art",
    "size": "512x512"
  }
}
```

### ğŸ­ å¯¹è¯éŸ³æ•ˆ (Gemini TTS) â­ æ–°åŠŸèƒ½
```javascript
// NPCå¯¹è¯é…éŸ³
{
  "tool": "generate_dialogue_audio",
  "arguments": {
    "text": "æ¬¢è¿æ¥åˆ°æˆ‘çš„åº—é“ºï¼éœ€è¦ä»€ä¹ˆæ­¦å™¨å—ï¼Ÿ",
    "character": "merchant",     // è§’è‰²ï¼šå•†äºº
    "emotion": "happy",          // æƒ…æ„Ÿï¼šå¿«ä¹
    "language": "zh-CN",         // è¯­è¨€ï¼šä¸­æ–‡
    "speed": 1.0,               // è¯­é€Ÿï¼šæ­£å¸¸
    "pitch": 0                  // éŸ³è°ƒï¼šæ ‡å‡†
  }
}
```

**æ”¯æŒçš„è§’è‰²**ï¼šwarrior(æˆ˜å£«), mage(æ³•å¸ˆ), merchant(å•†äºº), princess(å…¬ä¸»), villain(åæ´¾), narrator(æ—ç™½)ç­‰

### ğŸ¼ èƒŒæ™¯éŸ³ä¹
```javascript
// ç”Ÿæˆå²è¯—ä¸»é¢˜éŸ³ä¹
{
  "tool": "generate_game_music",
  "arguments": {
    "prompt": "å²è¯—èˆ¬çš„å†’é™©ä¸»é¢˜ï¼Œå±•ç°è‹±é›„çš„æ—…ç¨‹",
    "musicType": "theme",
    "genre": "orchestral",
    "mood": "epic",
    "duration": 60,
    "isLooping": true
  }
}
```

### ğŸ“Š æ•°æ®åº“æ“ä½œ
```javascript
// ä¿å­˜ç©å®¶æ•°æ®
{
  "tool": "mongodb_insert",
  "arguments": {
    "collection": "players",
    "data": {
      "name": "è‹±é›„001",
      "level": 15,
      "class": "warrior"
    }
  }
}
```

## ğŸ­ Gemini TTS ç‰¹è‰²åŠŸèƒ½

### è§’è‰²åŒ–è¯­éŸ³é…ç½®
æ¯ä¸ªè§’è‰²éƒ½æœ‰ç‹¬ç‰¹çš„å£°éŸ³ç‰¹å¾ï¼š

| è§’è‰² | æè¿° | æ¨èä½¿ç”¨åœºæ™¯ |
|------|------|-------------|
| `warrior` | é›„æµ‘æœ‰åŠ›ï¼Œå……æ»¡æˆ˜æ–—ç²¾ç¥ | æˆ˜æ–—å‘å–Šã€è‹±é›„å®£è¨€ |
| `mage` | ç¥ç§˜ä¼˜é›…ï¼Œå¸¦æœ‰é­”æ³•éŸµå‘³ | å’’è¯­å¿µè¯µã€æ™ºæ…§å¯¹è¯ |
| `merchant` | çƒ­æƒ…è¯šæ³ï¼Œå¯Œæœ‰äº²å’ŒåŠ› | å•†åº—äº¤æ˜“ã€å‹å¥½é—®å€™ |
| `princess` | ä¼˜é›…æ¸©æŸ”ï¼Œæ°”è´¨éå‡¡ | å‰§æƒ…å¯¹è¯ã€æ„Ÿè°¢è¯è¯­ |
| `villain` | é˜´é™©ç‹¡è¯ˆï¼Œä»¤äººèƒ†å¯’ | åæ´¾å¨èƒã€é‚ªæ¶è®¡åˆ’ |
| `narrator` | å¹³é™å®¢è§‚ï¼Œä¸“ä¸šæ¸…æ™° | ç³»ç»Ÿæç¤ºã€æ•…äº‹å™è¿° |

### å¤šè¯­è¨€æ”¯æŒ
- **ä¸­æ–‡ (zh-CN)**: æ ‡å‡†æ™®é€šè¯ï¼Œå¤šç§éŸ³è‰²
- **è‹±æ–‡ (en-US)**: ç¾å¼å‘éŸ³ï¼Œé€‚åˆå›½é™…åŒ–
- **æ—¥æ–‡ (ja-JP)**: æ ‡å‡†æ—¥è¯­å‘éŸ³
- **éŸ©æ–‡ (ko-KR)**: æ ‡å‡†éŸ©è¯­å‘éŸ³

### é«˜çº§æ§åˆ¶å‚æ•°
- **è¯­é€Ÿæ§åˆ¶**: 0.25x - 4.0x (é€‚åº”ä¸åŒåœºæ™¯èŠ‚å¥)
- **éŸ³è°ƒè°ƒèŠ‚**: -20 åˆ° +20 åŠéŸ³ (åˆ›é€ ç‹¬ç‰¹å£°éŸ³)
- **æƒ…æ„Ÿè¡¨è¾¾**: 8ç§æƒ…æ„ŸçŠ¶æ€ (neutral, happy, angry, sad, excited, calm, serious, heroic)

## ğŸ§ª æµ‹è¯•åŠŸèƒ½

### å¿«é€Ÿæµ‹è¯•Gemini TTS
```bash
# è¿è¡Œä¸“é—¨çš„TTSæµ‹è¯•
.\test-gemini-tts.bat
```

æµ‹è¯•å°†æ‰§è¡Œï¼š
- âœ… å•†äººè§’è‰²å¿«ä¹å¯¹è¯
- âœ… æˆ˜å£«è§’è‰²æ„¤æ€’å‘å–Š  
- âœ… è‹±æ–‡è‹±é›„å®£è¨€
- âœ… éŸ³é¢‘æ–‡ä»¶ç”Ÿæˆ

## ğŸ“ é¡¹ç›®ç»“æ„

```
mcp-server/
â”œâ”€â”€ src/                        # æºä»£ç 
â”‚   â”œâ”€â”€ index.ts               # ä¸»æœåŠ¡å™¨
â”‚   â””â”€â”€ services/
â”‚       â”œâ”€â”€ imageGeneration.ts     # å›¾ç‰‡ç”Ÿæˆ
â”‚       â”œâ”€â”€ gameDialogueService.ts # å¯¹è¯éŸ³æ•ˆ (Gemini TTS)
â”‚       â”œâ”€â”€ gameMusicService.ts    # èƒŒæ™¯éŸ³ä¹
â”‚       â””â”€â”€ mongodbService.ts      # æ•°æ®åº“
â”œâ”€â”€ generated_audio/           # ç”Ÿæˆçš„éŸ³é¢‘æ–‡ä»¶
â”œâ”€â”€ generated_music/          # ç”Ÿæˆçš„éŸ³ä¹æ–‡ä»¶
â”œâ”€â”€ examples/                 # ä½¿ç”¨ç¤ºä¾‹
â”œâ”€â”€ .env                     # ç¯å¢ƒé…ç½®
â””â”€â”€ README.md               # è¯¦ç»†æ–‡æ¡£
```

## âš™ï¸ ç¯å¢ƒé…ç½®

### .env æ–‡ä»¶ç¤ºä¾‹
```env
# Gemini APIå¯†é’¥ (å›¾ç‰‡ç”Ÿæˆ + å¯¹è¯éŸ³æ•ˆ)
GEMINI_API_KEY=your_gemini_api_key_here

# MongoDBæ•°æ®åº“è¿æ¥
MONGODB_URI=mongodb://localhost:27017/swl

# LyriaéŸ³ä¹ç”ŸæˆAPI (å¯é€‰ï¼Œæœªæ¥åŠŸèƒ½)
# LYRIA_API_KEY=your_lyria_api_key
```

### è·å–Gemini APIå¯†é’¥
1. è®¿é—® [Google AI Studio](https://makersuite.google.com/app/apikey)
2. ç™»å½•Googleè´¦å·
3. åˆ›å»ºæ–°çš„APIå¯†é’¥
4. å¤åˆ¶å¯†é’¥åˆ°.envæ–‡ä»¶

## ğŸ¯ å®ç”¨ç¤ºä¾‹

### åˆ›å»ºå®Œæ•´çš„NPC
```javascript
// 1. ç”ŸæˆNPCå½¢è±¡
{
  "tool": "generate_game_image",
  "arguments": {
    "prompt": "å‹å–„çš„è€é“åŒ ï¼Œç©¿ç€çš®é©å›´è£™",
    "style": "realistic"
  }
}

// 2. å½•åˆ¶NPCå¯¹è¯
{
  "tool": "generate_dialogue_audio", 
  "arguments": {
    "text": "æ¬¢è¿ï¼æˆ‘æ˜¯è¿™é‡Œæœ€å¥½çš„é“åŒ ï¼Œéœ€è¦ä¿®ç†è£…å¤‡å—ï¼Ÿ",
    "character": "merchant",
    "emotion": "happy",
    "language": "zh-CN"
  }
}

// 3. ä¿å­˜NPCæ•°æ®
{
  "tool": "mongodb_insert",
  "arguments": {
    "collection": "npcs",
    "data": {
      "name": "é“åŒ æ±¤å§†",
      "type": "blacksmith",
      "dialogue": ["æ¬¢è¿ï¼æˆ‘æ˜¯è¿™é‡Œæœ€å¥½çš„é“åŒ ï¼Œéœ€è¦ä¿®ç†è£…å¤‡å—ï¼Ÿ"],
      "voiceConfig": {
        "character": "merchant",
        "emotion": "happy"
      }
    }
  }
}
```

### å¤šè¯­è¨€è§’è‰²å¯¹è¯
```javascript
// ä¸­æ–‡å¥³æ³•å¸ˆ
{
  "tool": "generate_dialogue_audio",
  "arguments": {
    "text": "å¤è€çš„é­”æ³•å³å°†è‹é†’ï¼Œæ„Ÿå—åŠ›é‡çš„å¬å”¤å§ï¼",
    "character": "mage",
    "emotion": "calm",
    "language": "zh-CN",
    "gender": "female",
    "speed": 0.9,
    "pitch": -2
  }
}

// è‹±æ–‡ç”·æˆ˜å£«
{
  "tool": "generate_dialogue_audio", 
  "arguments": {
    "text": "For honor and glory! We shall not surrender!",
    "character": "warrior",
    "emotion": "heroic", 
    "language": "en-US",
    "gender": "male",
    "speed": 1.2,
    "pitch": 3
  }
}

// æ—¥æ–‡å…¬ä¸»
{
  "tool": "generate_dialogue_audio",
  "arguments": {
    "text": "ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ã€å‹‡è€…æ§˜ã€‚",
    "character": "princess",
    "emotion": "happy",
    "language": "ja-JP",
    "gender": "female"
  }
}
```

## ğŸ”§ å¸¸è§é—®é¢˜

### Q: APIå¯†é’¥é”™è¯¯æ€ä¹ˆåŠï¼Ÿ
**A**: æ£€æŸ¥ä»¥ä¸‹æ­¥éª¤ï¼š
1. ç¡®è®¤.envæ–‡ä»¶ä¸­GEMINI_API_KEYè®¾ç½®æ­£ç¡®
2. éªŒè¯APIå¯†é’¥æ˜¯å¦æœ‰æ•ˆï¼ˆè®¿é—®Google AI Studioï¼‰
3. ç¡®è®¤ç½‘ç»œè¿æ¥æ­£å¸¸

### Q: MongoDBè¿æ¥å¤±è´¥ï¼Ÿ
**A**: ç¡®ä¿MongoDBæœåŠ¡æ­£åœ¨è¿è¡Œï¼š
```bash
# Windows
net start MongoDB

# æˆ–ç›´æ¥å¯åŠ¨MongoDBæœåŠ¡
mongod
```

### Q: éŸ³é¢‘æ–‡ä»¶åœ¨å“ªé‡Œï¼Ÿ
**A**: ç”Ÿæˆçš„éŸ³é¢‘æ–‡ä»¶ä¿å­˜åœ¨ `./generated_audio/` ç›®å½•ä¸­ã€‚å½“å‰ä¸ºæ¨¡æ‹Ÿç”Ÿæˆæ¨¡å¼ï¼Œå®é™…é›†æˆéœ€è¦ç­‰å¾…Gemini TTS APIæ­£å¼å‘å¸ƒã€‚

### Q: å¦‚ä½•åˆ‡æ¢ä¸ºå®é™…çš„TTS APIï¼Ÿ
**A**: å½“Gemini TTS APIæ­£å¼å‘å¸ƒåï¼Œä¿®æ”¹ `gameDialogueService.ts` ä¸­çš„ `generateAudioWithGemini` æ–¹æ³•ï¼Œæ ¹æ®å®˜æ–¹APIæ–‡æ¡£è°ƒæ•´è¯·æ±‚æ ¼å¼ã€‚

## ğŸš€ è¿›é˜¶ä½¿ç”¨

### è‡ªå®šä¹‰è§’è‰²å£°éŸ³
```javascript
// åˆ›å»ºè‡ªå®šä¹‰è§’è‰²é…ç½®
{
  "tool": "generate_dialogue_audio",
  "arguments": {
    "text": "è¿™æ˜¯è‡ªå®šä¹‰çš„è§’è‰²å£°éŸ³",
    "character": "default",     // ä½¿ç”¨é»˜è®¤è§’è‰²
    "emotion": "neutral",
    "language": "zh-CN", 
    "gender": "male",          // æ‰‹åŠ¨æŒ‡å®šæ€§åˆ«
    "speed": 0.8,             // æ…¢é€Ÿ
    "pitch": -5               // ä½éŸ³è°ƒ
  }
}
```

### æ‰¹é‡ç”Ÿæˆå¯¹è¯
å¯¹äºå¤§é‡å¯¹è¯ï¼Œå»ºè®®ï¼š
1. å‡†å¤‡å¯¹è¯åˆ—è¡¨
2. ä½¿ç”¨è„šæœ¬æ‰¹é‡è°ƒç”¨MCPå·¥å…·
3. ç»Ÿä¸€ç®¡ç†éŸ³é¢‘æ–‡ä»¶å‘½å

### æ€§èƒ½ä¼˜åŒ–å»ºè®®
- ğŸ”„ å¯ç”¨éŸ³é¢‘æ–‡ä»¶ç¼“å­˜
- ğŸ“ å®šæœŸæ¸…ç†ä¸´æ—¶æ–‡ä»¶
- âš¡ ä½¿ç”¨MongoDBç´¢å¼•ä¼˜åŒ–æŸ¥è¯¢
- ğŸ¯ æ ¹æ®æ¸¸æˆéœ€è¦è°ƒæ•´éŸ³é¢‘è´¨é‡å‚æ•°

## ğŸ“š æ›´å¤šèµ„æº

- ğŸ“– [å®Œæ•´æŠ€æœ¯æ–‡æ¡£](README.md)
- ğŸ’¡ [ä½¿ç”¨ç¤ºä¾‹é›†åˆ](examples/usage-examples.json)
- ğŸ”— [Gemini AIå®˜æ–¹æ–‡æ¡£](https://ai.google.dev/)
- ğŸ® [MCPåè®®è§„èŒƒ](https://modelcontextprotocol.io/)

---

ğŸ‰ **ç¥ä½ æ¸¸æˆå¼€å‘æ„‰å¿«ï¼ä½¿ç”¨Gemini AIçš„åŠ›é‡ï¼Œä¸ºä½ çš„æ¸¸æˆè§’è‰²æ³¨å…¥ç”Ÿå‘½åŠ›ï¼** 